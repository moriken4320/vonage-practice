<p>キャンペーン配信画面：モデレーター</p>
<p>タイトル：<%= @campaign.title %></p>
<p>セッションID：<%= @campaign.session_id %></p>

<div id="moderator-wrapper">
    <div v-if="!vonageHelper.isConnected" id="join-wrapper">
        <input type="text" id="user-name" v-model="userName" placeholder="名前を入力">
        <button @click="join">入室</button>
    </div>
    <div id="video-wrapper">
        <div>
            <div id="videos"></div>
            <div id="screen"></div>
        </div>
        <div id="user-interface">
            <div>
                <button @click="vonageHelper.setAudioEnabled(!vonageHelper.enableAudio)">{{ audioButtonText }}</button>
                <button @click="vonageHelper.setVideoEnabled(!vonageHelper.enableVideo)">{{ videoButtonText }}</button>
            </div>
            <div>
                <select @change="vonageHelper.setAudioSource(event.target.value)">
                    <option
                    v-for="audioDevice in vonageHelper.audioDeviceList"
                    :value="audioDevice.deviceId"
                    :selected="vonageHelper.selectedAudioDeviceId === audioDevice.deviceId">
                        {{ audioDevice.label }}
                    </option>
                </select>
                <select @change="vonageHelper.setVideoSource(event.target.value)">
                    <option
                    v-for="videoDevice in vonageHelper.videoDeviceList"
                    :value="videoDevice.deviceId"
                    :selected="vonageHelper.selectedVideoDeviceId === videoDevice.deviceId">
                        {{  videoDevice.label }}
                    </option>
                </select>
            </div>
            <div id="audio-level"><div></div></div>
            <div v-if="vonageHelper.isConnected">
                <button @click="connect">{{ connectButtonText }}</button>
                <button @click="vonageHelper.startScreenShare()" v-if="vonageHelper.isPublished">screen share</button>
                <button @click="broadcast">{{ broadcastButtonText }}</button>
                <button @click="recording" v-if="vonageHelper.isPublished">{{ recordingButtonText }}</button>
            </div>
        </div>
        <div id="request-area" v-if="vonageHelper.isConnected">
            <div style="font-weight: bold;">参加リクエスト</div>
            <div v-for="request in authRequests">
                <div>name:
                    <input type="text" v-model="request.data">
                    <button @click="allowRequest(request)">承認</button>
                    <button @click="removeRequest(request)">拒否</button>
                </div>
            </div>
        </div>
        <div id="panelist-area" v-if="vonageHelper.isConnected">
            <div style="font-weight: bold;">パネリスト</div>
            <div v-for="subscriber in vonageHelper.subscribeObjs">
                <label>
                    <input type="radio" name="signal_target" :value="subscriber.stream.connection" v-model="signalText['to']">
                    <span>id: {{ subscriber.stream.connection.id }} , name: {{ subscriber.stream.connection.data }}</span>
                </label>
            </div>
        </div>
        <div id="message-area" v-if="vonageHelper.isConnected">
            <div>
                <span style="font-weight: bold;">シグナル</span>
                <label>
                    <input type="radio" name="signal_target" :value="null" v-model="signalText['to']">
                    <span>not signal target</span>
                </label>
            </div>
            <div>
                <input type="text" placeholder="type" v-model="signalText['type']">
                <input type="text" placeholder="data" v-model="signalText['data']">
                <button @click="sendSignal">送信</button>
            </div>
            <div v-for="signal in vonageHelper.signalObj">type: {{ signal.type }}, data: {{ signal.data }}</div>
        </div>
    </div>
</div>

<script type="text/javascript">
    <%= render "show_moderator.js" %>
</script>